<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C Container Collection (CCC): CCC_Flat_hash_map Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C Container Collection (CCC)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structCCC__Flat__hash__map.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">CCC_Flat_hash_map Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="private__flat__hash__map_8h_source.html">private_flat_hash_map.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for CCC_Flat_hash_map:</div>
<div class="dyncontent">
<div class="center"><img src="structCCC__Flat__hash__map__coll__graph.png" border="0" usemap="#aCCC__Flat__hash__map_coll__map" alt="Collaboration graph"/></div>
<map name="aCCC__Flat__hash__map_coll__map" id="aCCC__Flat__hash__map_coll__map">
<area shape="rect" title=" " alt="" coords="19,93,174,119"/>
<area shape="rect" href="structCCC__Flat__hash__map__tag.html" title=" " alt="" coords="5,5,188,31"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The layout of the map uses only pointers to account for the possibility of memory provided from the data segment, stack, or heap. When the map is allowed to allocate it will take care of aligning pointers appropriately. In the fixed size case we rely on the user defining a fixed size type. In either case the arrays are in one contiguous allocation but split as follows:</p>
<p>(N == capacity - 1) Where capacity is a power of 2. (G == group size - 1).</p>
<p>┌───┬───┬───┬───┬────┬───┬───┬───┬───┬───┬───┬───┬───┐ │D_0│D_1│...│D_N│Swap│T_0│T_1│...│T_N│R_0│R_1│...│R_G│ └───┴───┴───┴───┴─┬──┼───┴───┴───┴───┼───┴───┴───┴───┘ ┌───────────────┘ │ │ ┌─┴───────────┐ ┌────┴─────────┐ ┌───┴──────────────────────────────────────┐ │Swap slot for│ │Base address │ │Start of replica of first group to support│ │in place │ │of Tag array. │ │a group load that starts at T_N as well as│ │rehashing. │ │Possible pad │ │erase and inserts. This means R_G is never│ │Size = 1 data│ │bytes between.│ │needed but duplicated for branchless ops. │ └─────────────┘ └──────────────┘ └──────────────────────────────────────────┘</p>
<p>This is a different layout than Rust's Hashbrown table. Instead of a shared base address of the data and tag arrays with padding at the start of the data array, we use a normal two array layout with padding between. This is because we must allow the user to allocate a hash table at compile time in the data segment or on the stack. The fixed size map defined at compile time is a struct and structs in the C standard are specified to have no padding at the start. Therefore, so that the code within the map does not care whether it deals with a fixed or dynamic map, we must assume data starts at the base address and that there may be zero or more bytes of padding between the data and tag arrays for alignment.</p>
<p>We may lose some of the assembly optimizations in indexing that Rust's table gets by adding and subtracting from a shared base address. However, this table still needs to use byte offset multiplication because the data is stored as <code>void *</code> so we don't have the same optimizations available to us as Rust's template generic system. Simple 0 based indexing makes the addition and multiplication we perform as simple as possible. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a8ac0f53e2cc071827f4d87e0d30bc18c"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#a8ac0f53e2cc071827f4d87e0d30bc18c">data</a></td></tr>
<tr class="separator:a8ac0f53e2cc071827f4d87e0d30bc18c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a736e20bf3a5399ad6256e95a2bc34866"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structCCC__Flat__hash__map__tag.html">CCC_Flat_hash_map_tag</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#a736e20bf3a5399ad6256e95a2bc34866">tag</a></td></tr>
<tr class="separator:a736e20bf3a5399ad6256e95a2bc34866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a7e81876c54d1b818b04743b2328ec"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#aa1a7e81876c54d1b818b04743b2328ec">count</a></td></tr>
<tr class="separator:aa1a7e81876c54d1b818b04743b2328ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68eef42bb9c395b1e9ade4a2bb680ff8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#a68eef42bb9c395b1e9ade4a2bb680ff8">remain</a></td></tr>
<tr class="separator:a68eef42bb9c395b1e9ade4a2bb680ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8991b262fe4d2595bad16460bf4dc4e5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#a8991b262fe4d2595bad16460bf4dc4e5">mask</a></td></tr>
<tr class="separator:a8991b262fe4d2595bad16460bf4dc4e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ac5a0651f942b94821ea041257fd4aa"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#a7ac5a0651f942b94821ea041257fd4aa">sizeof_type</a></td></tr>
<tr class="separator:a7ac5a0651f942b94821ea041257fd4aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87df703d579e68a09558dc1a9c773525"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#a87df703d579e68a09558dc1a9c773525">key_offset</a></td></tr>
<tr class="separator:a87df703d579e68a09558dc1a9c773525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41aef79c27d7c76cfcb4a43ffe0c0dca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a70073fb5defeba83308b92f2fff63fac">CCC_Key_comparator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#a41aef79c27d7c76cfcb4a43ffe0c0dca">compare</a></td></tr>
<tr class="separator:a41aef79c27d7c76cfcb4a43ffe0c0dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae115aba9dcc8fe51f374ed2cc931feac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#ac8ab9304af176b1e7c135e7464a7488f">CCC_Key_hasher</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#ae115aba9dcc8fe51f374ed2cc931feac">hash</a></td></tr>
<tr class="separator:ae115aba9dcc8fe51f374ed2cc931feac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af187da4042352b19620063926a6a7407"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#aac6280c471e14b9c0d50b1c5577394d3">CCC_Allocator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#af187da4042352b19620063926a6a7407">allocate</a></td></tr>
<tr class="separator:af187da4042352b19620063926a6a7407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a614cac31b8d29442073e0dbc8ee86704"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCCC__Flat__hash__map.html#a614cac31b8d29442073e0dbc8ee86704">context</a></td></tr>
<tr class="separator:a614cac31b8d29442073e0dbc8ee86704"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Field Documentation</h2>
<a id="af187da4042352b19620063926a6a7407" name="af187da4042352b19620063926a6a7407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af187da4042352b19620063926a6a7407">&#9670;&#160;</a></span>allocate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#aac6280c471e14b9c0d50b1c5577394d3">CCC_Allocator</a>* CCC_Flat_hash_map::allocate</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The allocation function, if any. </p>

</div>
</div>
<a id="a41aef79c27d7c76cfcb4a43ffe0c0dca" name="a41aef79c27d7c76cfcb4a43ffe0c0dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41aef79c27d7c76cfcb4a43ffe0c0dca">&#9670;&#160;</a></span>compare</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a70073fb5defeba83308b92f2fff63fac">CCC_Key_comparator</a>* CCC_Flat_hash_map::compare</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The user callback for equality comparison. </p>

</div>
</div>
<a id="a614cac31b8d29442073e0dbc8ee86704" name="a614cac31b8d29442073e0dbc8ee86704"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a614cac31b8d29442073e0dbc8ee86704">&#9670;&#160;</a></span>context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* CCC_Flat_hash_map::context</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Auxiliary data, if any. </p>

</div>
</div>
<a id="aa1a7e81876c54d1b818b04743b2328ec" name="aa1a7e81876c54d1b818b04743b2328ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a7e81876c54d1b818b04743b2328ec">&#9670;&#160;</a></span>count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CCC_Flat_hash_map::count</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The number of user active slots. </p>

</div>
</div>
<a id="a8ac0f53e2cc071827f4d87e0d30bc18c" name="a8ac0f53e2cc071827f4d87e0d30bc18c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac0f53e2cc071827f4d87e0d30bc18c">&#9670;&#160;</a></span>data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* CCC_Flat_hash_map::data</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reversed user type data array. </p>

</div>
</div>
<a id="ae115aba9dcc8fe51f374ed2cc931feac" name="ae115aba9dcc8fe51f374ed2cc931feac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae115aba9dcc8fe51f374ed2cc931feac">&#9670;&#160;</a></span>hash</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#ac8ab9304af176b1e7c135e7464a7488f">CCC_Key_hasher</a>* CCC_Flat_hash_map::hash</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The hash function provided by user. </p>

</div>
</div>
<a id="a87df703d579e68a09558dc1a9c773525" name="a87df703d579e68a09558dc1a9c773525"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87df703d579e68a09558dc1a9c773525">&#9670;&#160;</a></span>key_offset</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CCC_Flat_hash_map::key_offset</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The location of the key field in user type. </p>

</div>
</div>
<a id="a8991b262fe4d2595bad16460bf4dc4e5" name="a8991b262fe4d2595bad16460bf4dc4e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8991b262fe4d2595bad16460bf4dc4e5">&#9670;&#160;</a></span>mask</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CCC_Flat_hash_map::mask</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The mask for power of two table sizing. </p>

</div>
</div>
<a id="a68eef42bb9c395b1e9ade4a2bb680ff8" name="a68eef42bb9c395b1e9ade4a2bb680ff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68eef42bb9c395b1e9ade4a2bb680ff8">&#9670;&#160;</a></span>remain</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CCC_Flat_hash_map::remain</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Track available slots given load factor constrains. When 0, rehash. </p>

</div>
</div>
<a id="a7ac5a0651f942b94821ea041257fd4aa" name="a7ac5a0651f942b94821ea041257fd4aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ac5a0651f942b94821ea041257fd4aa">&#9670;&#160;</a></span>sizeof_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t CCC_Flat_hash_map::sizeof_type</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Size of each user data element being stored. </p>

</div>
</div>
<a id="a736e20bf3a5399ad6256e95a2bc34866" name="a736e20bf3a5399ad6256e95a2bc34866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a736e20bf3a5399ad6256e95a2bc34866">&#9670;&#160;</a></span>tag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structCCC__Flat__hash__map__tag.html">CCC_Flat_hash_map_tag</a>* CCC_Flat_hash_map::tag</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tag array on byte following <a class="el" href="structCCC__Flat__hash__map.html#a8ac0f53e2cc071827f4d87e0d30bc18c">data(0)</a>. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>ccc/private/<a class="el" href="private__flat__hash__map_8h_source.html">private_flat_hash_map.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structCCC__Flat__hash__map.html">CCC_Flat_hash_map</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
